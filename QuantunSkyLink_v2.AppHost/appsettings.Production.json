{
  "$schema": "https://json.schemastore.org/appsettings.json",
  "$comment": "PRODUCTION TEMPLATE - All sensitive values should be stored in AWS Secrets Manager",
  "Logging": {
    "LogLevel": {
      "Default": "Warning",
      "Microsoft.AspNetCore": "Warning",
      "QuantumSkyLink": "Information",
      "Aspire": "Warning"
    },
    "ApplicationInsights": {
      "LogLevel": {
        "Default": "Information"
      }
    }
  },
  "AllowedHosts": "api.quantumskylink.com;*.quantumskylink.com",
  
  "AWS": {
    "Profile": "${AWS_PROFILE}",
    "Region": "${AWS_REGION}",
    "UseSecretsManager": true,
    "SecretsManagerPrefix": "qsl/production/",
    "ParameterStorePrefix": "/qsl/production/config/",
    "EventBridge": {
      "BusName": "${aws:parameter:/qsl/production/config/eventbridge/bus}",
      "Enabled": true
    },
    "SQS": {
      "QueueUrlPrefix": "${aws:parameter:/qsl/production/config/sqs/prefix}",
      "DefaultVisibilityTimeout": 30,
      "MaxReceiveCount": 5
    },
    "CloudWatch": {
      "Enabled": true,
      "LogGroupPrefix": "/ecs/qsl-production",
      "RetentionInDays": 90
    }
  },
  
  "ConnectionStrings": {
    "postgres-userservice": "${aws:secrets:qsl/production/neon/userservice}",
    "postgres-accountservice": "${aws:secrets:qsl/production/neon/accountservice}",
    "postgres-paymentgatewayservice": "${aws:secrets:qsl/production/neon/paymentgateway}",
    "postgres-treasuryservice": "${aws:secrets:qsl/production/neon/treasury}",
    "postgres-tokenservice": "${aws:secrets:qsl/production/neon/tokenservice}",
    "postgres-feeservice": "${aws:secrets:qsl/production/neon/feeservice}",
    "postgres-governanceservice": "${aws:secrets:qsl/production/neon/governance}",
    "postgres-complianceservice": "${aws:secrets:qsl/production/neon/compliance}",
    "postgres-securityservice": "${aws:secrets:qsl/production/neon/security}",
    "postgres-notificationservice": "${aws:secrets:qsl/production/neon/notification}",
    "postgres-liquidationservice": "${aws:secrets:qsl/production/neon/liquidation}",
    "postgres-infrastructureservice": "${aws:secrets:qsl/production/neon/infrastructure}",
    "postgres-identityverificationservice": "${aws:secrets:qsl/production/neon/identity}",
    "postgres-aireviewservice": "${aws:secrets:qsl/production/neon/aireview}",
    "postgres-marketplaceservice": "${aws:secrets:qsl/production/neon/marketplace}",
    "postgres-signatureservice": "${aws:secrets:qsl/production/neon/signature}",
    "postgres-orchestrationservice": "${aws:secrets:qsl/production/neon/orchestration}",
    "postgres-quantumledgerhub": "${aws:secrets:qsl/production/neon/quantumledger}",
    
    "redis": "${aws:secrets:qsl/production/redis/connection}",
    "surrealdb": "${aws:secrets:qsl/production/surrealdb/connection}"
  },
  
  "Blockchain": {
    "Alchemy": {
      "ApiKeySepolia": "${aws:secrets:qsl/production/alchemy/sepolia:apiKey}",
      "ApiKeyPolygonMumbai": "${aws:secrets:qsl/production/alchemy/polygon:apiKey}",
      "ApiKeyArbitrumSepolia": "${aws:secrets:qsl/production/alchemy/arbitrum:apiKey}"
    },
    "Infura": {
      "ProjectId": "${aws:secrets:qsl/production/infura:projectId}",
      "ProjectSecret": "${aws:secrets:qsl/production/infura:projectSecret}"
    },
    "MultiChain": {
      "RpcUrl": "${aws:parameter:/qsl/production/config/multichain/url}",
      "RpcUsername": "${aws:secrets:qsl/production/multichain:username}",
      "RpcPassword": "${aws:secrets:qsl/production/multichain:password}"
    }
  },
  
  "Security": {
    "JWT": {
      "Secret": "${aws:secrets:qsl/production/jwt:secret}",
      "Issuer": "https://api.quantumskylink.com",
      "Audience": "quantumskylink-api",
      "ExpirationMinutes": 30,
      "RefreshExpirationDays": 7,
      "ValidateLifetime": true,
      "ValidateIssuer": true,
      "ValidateAudience": true,
      "RequireHttpsMetadata": true
    },
    "PQC": {
      "Algorithm": "Dilithium2",
      "PrivateKey": "${aws:secrets:qsl/production/pqc:privateKey}",
      "PublicKey": "${aws:secrets:qsl/production/pqc:publicKey}",
      "KeyRotationDays": 30,
      "ValidationEnabled": true
    },
    "ApiKeys": {
      "InternalServiceKey": "${aws:secrets:qsl/production/api:internalKey}",
      "AdminApiKey": "${aws:secrets:qsl/production/api:adminKey}"
    }
  },
  
  "Logto": {
    "Authority": "${aws:parameter:/qsl/production/config/logto/authority}",
    "ClientId": "${aws:secrets:qsl/production/logto:clientId}",
    "ClientSecret": "${aws:secrets:qsl/production/logto:clientSecret}",
    "Resource": "https://api.quantumskylink.com",
    "Scopes": ["openid", "profile", "email"]
  },
  
  "Kestra": {
    "BaseUrl": "${aws:parameter:/qsl/production/config/kestra/url}",
    "Username": "${aws:secrets:qsl/production/kestra:username}",
    "Password": "${aws:secrets:qsl/production/kestra:password}",
    "Namespace": "quantumskylink",
    "ApiVersion": "v1"
  },
  
  "DotsDev": {
    "AppId": "${aws:secrets:qsl/production/dotsdev:appId}",
    "API": {
      "ClientId": "${aws:secrets:qsl/production/dotsdev:clientId}",
      "ApiKey": "${aws:secrets:qsl/production/dotsdev:apiKey}"
    },
    "WebHooks": {
      "AppId": "${aws:secrets:qsl/production/dotsdev:webhookAppId}",
      "WebhookIntegrationKey": "${aws:secrets:qsl/production/dotsdev:webhookKey}"
    }
  },
  
  "Monitoring": {
    "ApplicationInsights": {
      "ConnectionString": "${aws:secrets:qsl/production/appinsights:connectionString}",
      "EnableAdaptiveSampling": true,
      "EnableDependencyTracking": true,
      "EnablePerformanceCountersCollection": true
    },
    "OpenTelemetry": {
      "Endpoint": "${aws:parameter:/qsl/production/config/otel/endpoint}",
      "Protocol": "grpc",
      "Headers": "api-key=${aws:secrets:qsl/production/otel:apiKey}",
      "ServiceName": "quantumskylink-production",
      "ServiceVersion": "${BUILD_VERSION}",
      "SamplingRatio": 0.1
    }
  },
  
  "Aspire": {
    "Dashboard": {
      "Enabled": false,
      "Note": "Dashboard runs as separate service in production"
    },
    "ServiceDiscovery": {
      "Enabled": true,
      "RefreshInterval": "00:01:00",
      "FailFast": true,
      "HealthCheckInterval": "00:00:30"
    },
    "HealthChecks": {
      "Enabled": true,
      "Interval": "00:00:30",
      "Timeout": "00:00:05",
      "FailFast": true
    },
    "Telemetry": {
      "Enabled": true,
      "SamplingRatio": 0.1,
      "ExportInterval": "00:00:30"
    },
    "FailFast": {
      "Enabled": true,
      "GlobalTimeout": "00:00:05",
      "CriticalTimeout": "00:00:03",
      "RemoveUnhealthyServices": true,
      "ImmediateFailover": true
    }
  },
  
  "FeatureManagement": {
    "EventBridge": {
      "Enabled": true,
      "MigrationMode": "complete"
    },
    "EnableExternalDependencies": true,
    "EnableBlockchainIntegration": true,
    "EnableAIReview": true,
    "EnableAdvancedCompliance": true,
    "EnableDevelopmentFeatures": false,
    "EnableMockServices": false,
    "EnableDebugEndpoints": false
  },
  
  "RateLimiting": {
    "Enabled": true,
    "PermitLimit": 1000,
    "Window": "00:01:00",
    "QueueLimit": 100,
    "SegmentsPerWindow": 6
  },
  
  "Cors": {
    "AllowedOrigins": [
      "https://app.quantumskylink.com",
      "https://admin.quantumskylink.com",
      "https://mobile.quantumskylink.com"
    ],
    "AllowedMethods": ["GET", "POST", "PUT", "DELETE"],
    "AllowedHeaders": ["Authorization", "Content-Type", "X-Request-ID"],
    "AllowCredentials": true,
    "MaxAge": 3600
  },
  
  "Performance": {
    "ResponseCompression": true,
    "EnableCaching": true,
    "CacheDuration": 300,
    "EnableMinification": true,
    "EnableBundling": true,
    "MaxConcurrentRequests": 1000,
    "RequestTimeout": 30
  },
  
  "Resilience": {
    "CircuitBreaker": {
      "Enabled": true,
      "FailureThreshold": 0.5,
      "SamplingDuration": "00:00:30",
      "MinimumThroughput": 10,
      "DurationOfBreak": "00:00:30"
    },
    "Retry": {
      "MaxAttempts": 3,
      "DelayMilliseconds": 1000,
      "MaxDelayMilliseconds": 30000,
      "BackoffType": "Exponential"
    },
    "Timeout": {
      "DefaultTimeoutSeconds": 30,
      "HttpTimeoutSeconds": 10
    }
  }
}